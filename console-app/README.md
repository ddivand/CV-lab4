# Консольные скрипты / приложения

Консольная часть приложения представлена тремя скриптами, разработанными в процессе выполнения лабораторной работы.

## l4.py

Данный скрипт наиболее универсален и может использоваться для обработкии как изображений, так и видео.

Более подробную информацию о запуске и аргументах можно получить стандартно через команду `python3 l4.py -h`

Несколько важных моментов:

- В качестве входных и выходных URL проще всего подавать пути к файлам. Ссылки на другие ресурсы (например **rtsp**) могут работать, однако возможно это потребует сторонней настройки jetson-inference и окружения на самой плате

- Передаваемое в `--detection_network` аргументе имя модели должно быть из [данного списка](https://github.com/dusty-nv/jetson-inference/blob/master/docs/detectnet-console-2.md#pre-trained-detection-models-available) и предварительно уставновлено в jetson-inference

- В строке `classifier = pipeline("image-classification", model="_insert_path_to_your_model_here_", device = 0)` загружается предварительно тренированная модель. В дальнейшем ей подается на вход PIL изображение и полученный результат обрабатывается для отрисовки текстовой метки на исходном изображении. В зависимости от модели, которую требуется здесь использовать, может потребоваться изменение в коде её использования

- `device = 0` в той же строчке указывает на то, что модель требуется загрузить на *CUDA* девайс. Вместо `0` может быть необходимо подставить другой ID девайса.

## l4_image.py

Данный скрипт является чуть более сжатой копией l4.py и предназначен для работы исключительно с изображениями.

Все особенности аналогичны описанным выше в l4.py секции

## test.py

Данный скрипт предназначен для тестирования производительности системы.

Изображения в заданной директории по очереди подаются в обработку. Полученные четыре интервала времени (на распознавание, на классификацию, на утилити вызовы, суммарное исполнения) выводятся в консоль. Так же происходит расчёт средних значений за всё время. Данный процесс повторяется бесконечно, пока пользователь не решит остановить программу.

Важно понимать, что классификация изображений происходит *опционально*, т.е. если на изображении нет объектов заданного класса, то и классификатор модель не будет вызвана. Это может породить существенную разницу во времени обработки и требует дополнительного внимания при использовании скрипта для тестирования производительности.